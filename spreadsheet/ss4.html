<!DOCTYPE html>
<html>
<head>
    <title>Editable Table Cell with Textarea</title>
    <style>
        table {
            border-collapse: collapse;
            width: 50%;
            margin: 20px auto;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
            word-wrap: break-word;
        }

        td {
            cursor: pointer;
        }

        td textarea {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            overflow: hidden;
            box-sizing: border-box;
        }

        td div {
            width: 100%;
            min-height: 1em; /* Ensures the cell has a minimum height */
            overflow: hidden;
            box-sizing: border-box;
            font-family: inherit;
            font-size: inherit;
            padding: 0;
        }

    </style>
</head>
<body>
    <table>
        <thead>
            <tr>
                <th>Column 1</th>
                <th>Column 2</th>
                <th>Column 3</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td ondblclick="makeEditable(this)"><textarea onblur="makeNonEditable(this)">Sample Text for Cell 1</textarea></td>
                <td ondblclick="makeEditable(this)"><textarea onblur="makeNonEditable(this)">Longer Sample Text for Cell 2</textarea></td>
                <td ondblclick="makeEditable(this)"><textarea onblur="makeNonEditable(this)">Even Longer Sample Text for Cell 3. This text will automatically wrap to fit the cell width and increase the cell height if needed.</textarea></td>
            </tr>
            <tr>
                <td><textarea oninput="autoAdjustHeight(this)">Sample Text for Cell 1</textarea></td>
                <td><textarea oninput="autoAdjustHeight(this)">Longer Sample Text for Cell 2</textarea></td>
                <td><textarea oninput="autoAdjustHeight(this)">Even Longer Sample Text for Cell 3. This text will automatically wrap to fit the cell width and increase the cell height if needed.</textarea></td>
            </tr>
            <tr>
                <td><div contenteditable="true">Sample Text for Cell 1</div></td>
                <td><div contenteditable="true">Longer Sample Text for Cell 2</div></td>
                <td><div contenteditable="true">Even Longer Sample Text for Cell 3. This text will automatically wrap to fit the cell width and increase the cell height if needed.</div></td>
            </tr>
        </tbody>
    </table>

    <script>
        function makeEditable(cell) {
            const textarea = document.createElement('textarea');
            textarea.value = cell.innerText.trim();
            cell.innerText = '';
            cell.appendChild(textarea);
            textarea.focus();
        }

        function makeNonEditable(textarea) {
            const cell = textarea.parentElement;
            cell.innerText = textarea.value;
        }

        function autoAdjustHeight(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

    </script>
</body>
</html>
