<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Spreadsheet Audio Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.5.0/sql-wasm.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.5.0/sql-wasm.wasm" type="application/wasm"></script>

    <link rel="stylesheet" href="styles.css">
    <!--
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=jebKs0z3"></script>
    -->
    <script>
        // // Check if the page is loaded from macOS
        // var isMacOS = /Macintosh|Mac OS X/i.test(navigator.userAgent);

        // // Function to load the script from a specific URL
        // function loadScript(url) {
        //     var script = document.createElement('script');
        //     script.src = url;
        //     script.onload = function () {
        //         console.log('Script loaded');
        //         // Perform additional actions after the script is loaded
        //     };
        //     document.head.appendChild(script);
        // }
        // //isMacOS = false;
        // // Conditionally load the script if isMacOS is true
        // if (!isMacOS) {
        //    // loadScript('https://code.responsivevoice.org/responsivevoice.js?key=jebKs0z3');
        // }
    </script>
</head>

<body>

    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            const thElements = document.querySelectorAll('th.resize');
            let currentTh;

            thElements.forEach(th => {
                th.addEventListener('mousedown', (e) => {
                    currentTh = e.target;
                    document.addEventListener('mousemove', resizeColumn);
                    document.addEventListener('mouseup', stopResize);
                });
            });

            function resizeColumn(e) {
                const width = e.pageX - currentTh.parentElement.offsetLeft;
                currentTh.style.width = width + 'px';
            }

            function stopResize() {
                document.removeEventListener('mousemove', resizeColumn);
                document.removeEventListener('mouseup', stopResize);
            }



            const selectElement = document.getElementById('studyLists');

            //     // Fetch the file names from the "/data/" folder
            //     fetch('/csvaudioplayer/data/')
            //         .then(response => response.text())
            //         .then(data => {
            //             // Create a new DOMParser
            //             const parser = new DOMParser();

            //             // Parse the HTML response
            //             const doc = parser.parseFromString(data, 'text/html');

            //             // Get the anchor elements representing the file names
            //             //const anchorElements = doc.querySelectorAll('a');
            //             const anchorElements = doc.querySelectorAll('a[href$=".csv"]');

            //             // Extract the file names from the anchor elements
            //             // const fileNames = Array.from(anchorElements).map(anchor => anchor.textContent);
            //             // const filePaths = Array.from(anchorElements).map(anchor => anchor.href);

            //             const optionSel = document.createElement('option');
            //             optionSel.text = "Select File";

            //             // Set the option value as the relative path of the file
            //             optionSel.value = '';

            //             selectElement.appendChild(optionSel);


            //             anchorElements.forEach(anchor => {

            //                 const fileName = anchor.getAttribute('href');

            //                 if (fileName.endsWith('.csv')) {

            //                     const option = document.createElement('option');
            //                     option.text = anchor.textContent;

            //                     // Set the option value as the relative path of the file
            //                     option.value = '/data/' + fileName;

            //                     selectElement.appendChild(option);
            //                 }
            //             });


            //         })
            //         .catch(error => {
            //             console.error('Error fetching file names:', error);
            //         });

        });
    </script>

<div class="playpopupdivclass" id="playpopupdiv">
    <button id="popupPlayButton">Play</button>
</div>

    <h2>Select a data source:</h2>
    <select id="selectDataSource" onchange="showDiv()">
        <option value="0">Select an option</option>
        <option value="1">Study Lists</option>
        <option value="2">Local CSV/JSON File</option>
        <option value="3">CSV/JSON File URL</option>
        <option value="4">Database Tables</option>
    </select>


    <div id="div1" style="display: none;">
        <h3>Select Study List</h3>
        <select id="studyLists">
            <option value="">Select File</option>
        </select>
    </div>
    <div id="div2" style="display: none;">
        <h3>Select Local CSV/JSON File</h3>
        <input type="file" id="csvFileInput" accept=".csv,.json">
    </div>
    <div id="div3" style="display: none;">
        <h3>CSV/JSON File URL</h3>
        <label for="urlInput">URL:</label>
        <input type="text" id="urlInput" placeholder="Enter URL" />

        <button type="button" id="csvURLInputBtn">Fetch Data</button>
    </div>
    <div id="div4" style="display: none;">
        <h3>Database Tables</h3>
        <div>
            <select id="selectSQLiteDb" onchange="loadDatabase()">
                <option value="0">Select DB</option>
                <option value="data/sqlite/dictionary_ja.db">Japanese</option>
                <option value="data/sqlite/dictionary_sakura_ex.db">Japanese Sakura Ex</option>
                <option value="data/sqlite/dictionary_en.db">English</option>
                <option value="data/sqlite/dictionary_sent_han.db">Jap Chi Sent</option>
                <option value="data/sqlite/dictionary_sent_fr.db">French Sent</option>
                <option value="data/sqlite/dictionary_sent_de.db">German Sent</option>
                <option value="data/sqlite/dictionary_tech.db">Tech</option>
                <option value="data/sqlite/dictionary_other.db">Other</option>
            </select>

            <button id="loadTablesButton" onclick="loadTableNames()">SQLite Tables</button>
            Records Per Page
            <input type="text" id="recordsPerPageInput" placeholder="Records Per Page" size="6" maxlength="6"
                value="100">
            Tables<select id="tableNameSelect"></select>
            Columns<select id="columnNameSelect"></select>
            <div class="dbcat-container">
                Unique<input type="checkbox" id="colHasCatChkbox">
                <input type="text" id="searchWord" placeholder="Enter word">
                <div class="dbcat-dropdown-content" id="dropdownContent">
                </div>
            </div>
            <button id="searchButton">Search</button>
        </div>
    </div>

    <div id="divOps" style="display: none;">

        <div>
            <!--
        <select id="studyLists">
            <option value="">Select File</option>
        </select>
        <input type="file" id="csvFileInput" accept=".csv,.json">

        <label for="urlInput">URL:</label>
        <input type="text" id="urlInput" placeholder="Enter URL" />

        <button type="button" id="csvURLInputBtn">Fetch Data</button>
                -->

            <div class="table">
                <div class="column">Total Items:<span id="recordCount">0</span></div>
                <div class="column">Selected Items:<span id="counterId">0</span></div>
            </div>

        </div>
        <br>

        <button onclick="deleteSelectedRows()">&#x1F5D1; Selected</button>
        <button onclick="deleteNonselectedRows()">&#x1F5D1; Unelected</button>
        <button id="downloadCsvBtn" disabled>&#x1F4E5; CSV</button>
        <!--
    <button id="searchSpeechSearch">Speech Search</button>
    <button id="searchSpeechSearchStop" disabled>Stop Speech Search</button>
    -->
        <button onclick="showColumnPopup()">Columns &#x2699;</button>
        <button id="popupButton">&#127760; Tranlation</button>
        <button id="clearResult" onclick="clearResults()">&#x1F58C;Clear Results</button>

        <!-- 
    <button onclick="addNewRow()">&#10133;Row</button>
    <button onclick="addNewColumn()">&#10133;Column</button>
    -->
        <button onclick="openCSVJSONConversionWindow()">&#128195;CSV/JSON Util</button>


        <br><br>
    </div>

    <div id="colpopup" class="filecolpopup">
        <h3>Select File Columns to Display</h3>
        <button onclick="checkAllFileCols()">Check All</button>
        <button onclick="uncheckAllFileCols()">Uncheck All</button>
        <div id="checkboxes"></div>
        <button onclick="hideFileColPopup()">Cancel</button>
        <!--
            <button id="filePopulateTableBtn" onclick="populateTableNew()">Populate Table</button>    
        -->
        <button id="filePopulateTableBtn">Populate Table</button>
    </div>
    <div id="columnPopup" class="popup">
        <h3>Select Columns to Display</h3>
        <div>
            Select Speak Options:

            <select id="cellHighlightSelect">
                <option value="highlightandenlarge">Highlight And Enlarge</option>
                <option value="highlight">Highlight</option>
                <option value="normal">Normal</option>
            </select>

            <input type="text" id="maxCellSpeakCounter" placeholder="Enter cell speak times" size="6" maxlength="6"
                value="1">
            <input type="text" id="speakSilenceTime" placeholder="Silence Time 500ms" size="6" maxlength="6">
        </div>
        <div>
            <h3></h3>
        </div>
        <div>
            <button onclick="checkAll()">Check All</button>
            <button onclick="uncheckAll()">Uncheck All</button>
            <!--
            <div id="columnCheckboxes"></div>
            -->


            <table id="columnCheckboxes"></table>
            <button onclick="hideColumnPopup()">Cancel</button>
            <button onclick="hideAndApplyColumnPopup()">Apply</button>
        </div>
    </div>
    <!--
    <div>
        <button id="loadTablesButton" onclick="loadTableNames()">SQLite Tables</button>     
        <input type="number" id="recordsPerPageInput" placeholder="Records Per Page" value="10">
        Tables<select id="tableNameSelect"></select>
        Columns<select id="columnNameSelect"></select>
        <input type="text" id="searchWord" placeholder="Enter word">
        <button id="searchButton">Search</button>     
    </div>
-->
    <table id="myTable">
    </table>

    <div id="paginationContainer"></div>

    <div id="transpopup" class="transpopup">
        <div class="transpopup-content">
            <table id="transsrcpopup-table">
                <tr>
                    <td>
                        <label >Category:</label>
                        <input type="text" id="transCategory" placeholder="Category" size="30" maxlength="50">

                        <label for="srclang">Source Language:</label>
                        <select id="srclang" aria-label="Language Translate Widget">
                            <option value="">Select Language</option>
                            <option value="en">English</option>
                            <option value="ja">Japanese</option>
                            <option value="af">Afrikaans</option>
                            <option value="sq">Albanian</option>
                            <option value="am">Amharic</option>
                            <option value="ar">Arabic</option>
                            <option value="hy">Armenian</option>
                            <option value="as">Assamese</option>
                            <option value="ay">Aymara</option>
                            <option value="az">Azerbaijani</option>
                            <option value="bm">Bambara</option>
                            <option value="eu">Basque</option>
                            <option value="be">Belarusian</option>
                            <option value="bn">Bengali</option>
                            <option value="bho">Bhojpuri</option>
                            <option value="bs">Bosnian</option>
                            <option value="bg">Bulgarian</option>
                            <option value="my">Burmese</option>
                            <option value="ca">Catalan</option>
                            <option value="ceb">Cebuano</option>
                            <option value="ny">Chichewa</option>
                            <option value="zh-CN">Chinese (Simplified)</option>
                            <option value="zh-TW">Chinese (Traditional)</option>
                            <option value="co">Corsican</option>
                            <option value="hr">Croatian</option>
                            <option value="cs">Czech</option>
                            <option value="da">Danish</option>
                            <option value="dv">Dhivehi</option>
                            <option value="doi">Dogri</option>
                            <option value="nl">Dutch</option>
                            <option value="eo">Esperanto</option>
                            <option value="et">Estonian</option>
                            <option value="ee">Ewe</option>
                            <option value="tl">Filipino</option>
                            <option value="fi">Finnish</option>
                            <option value="fr">French</option>
                            <option value="fy">Frisian</option>
                            <option value="gl">Galician</option>
                            <option value="ka">Georgian</option>
                            <option value="de">German</option>
                            <option value="el">Greek</option>
                            <option value="gn">Guarani</option>
                            <option value="gu">Gujarati</option>
                            <option value="ht">Haitian Creole</option>
                            <option value="ha">Hausa</option>
                            <option value="haw">Hawaiian</option>
                            <option value="iw">Hebrew</option>
                            <option value="hi">Hindi</option>
                            <option value="hmn">Hmong</option>
                            <option value="hu">Hungarian</option>
                            <option value="is">Icelandic</option>
                            <option value="ig">Igbo</option>
                            <option value="ilo">Ilocano</option>
                            <option value="id">Indonesian</option>
                            <option value="ga">Irish Gaelic</option>
                            <option value="it">Italian</option>
                            <option value="jw">Javanese</option>
                            <option value="kn">Kannada</option>
                            <option value="kk">Kazakh</option>
                            <option value="km">Khmer</option>
                            <option value="rw">Kinyarwanda</option>
                            <option value="gom">Konkani</option>
                            <option value="ko">Korean</option>
                            <option value="kri">Krio</option>
                            <option value="ku">Kurdish (Kurmanji)</option>
                            <option value="ckb">Kurdish (Sorani)</option>
                            <option value="ky">Kyrgyz</option>
                            <option value="lo">Lao</option>
                            <option value="la">Latin</option>
                            <option value="lv">Latvian</option>
                            <option value="ln">Lingala</option>
                            <option value="lt">Lithuanian</option>
                            <option value="lg">Luganda</option>
                            <option value="lb">Luxembourgish</option>
                            <option value="mk">Macedonian</option>
                            <option value="mai">Maithili</option>
                            <option value="mg">Malagasy</option>
                            <option value="ms">Malay</option>
                            <option value="ml">Malayalam</option>
                            <option value="mt">Maltese</option>
                            <option value="mi">Maori</option>
                            <option value="mr">Marathi</option>
                            <option value="mni-Mtei">Meiteilon (Manipuri)</option>
                            <option value="lus">Mizo</option>
                            <option value="mn">Mongolian</option>
                            <option value="ne">Nepali</option>
                            <option value="no">Norwegian</option>
                            <option value="or">Odia (Oriya)</option>
                            <option value="om">Oromo</option>
                            <option value="ps">Pashto</option>
                            <option value="fa">Persian</option>
                            <option value="pl">Polish</option>
                            <option value="pt">Portuguese</option>
                            <option value="pa">Punjabi</option>
                            <option value="qu">Quechua</option>
                            <option value="ro">Romanian</option>
                            <option value="ru">Russian</option>
                            <option value="sm">Samoan</option>
                            <option value="sa">Sanskrit</option>
                            <option value="gd">Scots Gaelic</option>
                            <option value="nso">Sepedi</option>
                            <option value="sr">Serbian</option>
                            <option value="st">Sesotho</option>
                            <option value="sn">Shona</option>
                            <option value="sd">Sindhi</option>
                            <option value="si">Sinhala</option>
                            <option value="sk">Slovak</option>
                            <option value="sl">Slovenian</option>
                            <option value="so">Somali</option>
                            <option value="es">Spanish</option>
                            <option value="su">Sundanese</option>
                            <option value="sw">Swahili</option>
                            <option value="sv">Swedish</option>
                            <option value="tg">Tajik</option>
                            <option value="ta">Tamil</option>
                            <option value="tt">Tatar</option>
                            <option value="te">Telugu</option>
                            <option value="th">Thai</option>
                            <option value="ti">Tigrinya</option>
                            <option value="ts">Tsonga</option>
                            <option value="tr">Turkish</option>
                            <option value="tk">Turkmen</option>
                            <option value="ak">Twi</option>
                            <option value="uk">Ukrainian</option>
                            <option value="ur">Urdu</option>
                            <option value="ug">Uyghur</option>
                            <option value="uz">Uzbek</option>
                            <option value="vi">Vietnamese</option>
                            <option value="cy">Welsh</option>
                            <option value="xh">Xhosa</option>
                            <option value="yi">Yiddish</option>
                            <option value="yo">Yoruba</option>
                            <option value="zu">Zulu</option>
                        </select>
                        <textarea id="srctext-popup" rows="4" cols="30"></textarea><br>
                    </td>
                </tr>
            </table>

            <table id="transpopup-table">
                <tr>
                    <td>
                        <label for="tgtlang-1">Translation Language:</label>
                        <select id="tgtlang-1" aria-label="Language Translate Widget">
                            <option value="">Select Language</option>
                            <option value="en">English</option>
                            <option value="ja">Japanese</option>
                            <option value="af">Afrikaans</option>
                            <option value="sq">Albanian</option>
                            <option value="am">Amharic</option>
                            <option value="ar">Arabic</option>
                            <option value="hy">Armenian</option>
                            <option value="as">Assamese</option>
                            <option value="ay">Aymara</option>
                            <option value="az">Azerbaijani</option>
                            <option value="bm">Bambara</option>
                            <option value="eu">Basque</option>
                            <option value="be">Belarusian</option>
                            <option value="bn">Bengali</option>
                            <option value="bho">Bhojpuri</option>
                            <option value="bs">Bosnian</option>
                            <option value="bg">Bulgarian</option>
                            <option value="my">Burmese</option>
                            <option value="ca">Catalan</option>
                            <option value="ceb">Cebuano</option>
                            <option value="ny">Chichewa</option>
                            <option value="zh-CN">Chinese (Simplified)</option>
                            <option value="zh-TW">Chinese (Traditional)</option>
                            <option value="co">Corsican</option>
                            <option value="hr">Croatian</option>
                            <option value="cs">Czech</option>
                            <option value="da">Danish</option>
                            <option value="dv">Dhivehi</option>
                            <option value="doi">Dogri</option>
                            <option value="nl">Dutch</option>
                            <option value="eo">Esperanto</option>
                            <option value="et">Estonian</option>
                            <option value="ee">Ewe</option>
                            <option value="tl">Filipino</option>
                            <option value="fi">Finnish</option>
                            <option value="fr">French</option>
                            <option value="fy">Frisian</option>
                            <option value="gl">Galician</option>
                            <option value="ka">Georgian</option>
                            <option value="de">German</option>
                            <option value="el">Greek</option>
                            <option value="gn">Guarani</option>
                            <option value="gu">Gujarati</option>
                            <option value="ht">Haitian Creole</option>
                            <option value="ha">Hausa</option>
                            <option value="haw">Hawaiian</option>
                            <option value="iw">Hebrew</option>
                            <option value="hi">Hindi</option>
                            <option value="hmn">Hmong</option>
                            <option value="hu">Hungarian</option>
                            <option value="is">Icelandic</option>
                            <option value="ig">Igbo</option>
                            <option value="ilo">Ilocano</option>
                            <option value="id">Indonesian</option>
                            <option value="ga">Irish Gaelic</option>
                            <option value="it">Italian</option>
                            <option value="jw">Javanese</option>
                            <option value="kn">Kannada</option>
                            <option value="kk">Kazakh</option>
                            <option value="km">Khmer</option>
                            <option value="rw">Kinyarwanda</option>
                            <option value="gom">Konkani</option>
                            <option value="ko">Korean</option>
                            <option value="kri">Krio</option>
                            <option value="ku">Kurdish (Kurmanji)</option>
                            <option value="ckb">Kurdish (Sorani)</option>
                            <option value="ky">Kyrgyz</option>
                            <option value="lo">Lao</option>
                            <option value="la">Latin</option>
                            <option value="lv">Latvian</option>
                            <option value="ln">Lingala</option>
                            <option value="lt">Lithuanian</option>
                            <option value="lg">Luganda</option>
                            <option value="lb">Luxembourgish</option>
                            <option value="mk">Macedonian</option>
                            <option value="mai">Maithili</option>
                            <option value="mg">Malagasy</option>
                            <option value="ms">Malay</option>
                            <option value="ml">Malayalam</option>
                            <option value="mt">Maltese</option>
                            <option value="mi">Maori</option>
                            <option value="mr">Marathi</option>
                            <option value="mni-Mtei">Meiteilon (Manipuri)</option>
                            <option value="lus">Mizo</option>
                            <option value="mn">Mongolian</option>
                            <option value="ne">Nepali</option>
                            <option value="no">Norwegian</option>
                            <option value="or">Odia (Oriya)</option>
                            <option value="om">Oromo</option>
                            <option value="ps">Pashto</option>
                            <option value="fa">Persian</option>
                            <option value="pl">Polish</option>
                            <option value="pt">Portuguese</option>
                            <option value="pa">Punjabi</option>
                            <option value="qu">Quechua</option>
                            <option value="ro">Romanian</option>
                            <option value="ru">Russian</option>
                            <option value="sm">Samoan</option>
                            <option value="sa">Sanskrit</option>
                            <option value="gd">Scots Gaelic</option>
                            <option value="nso">Sepedi</option>
                            <option value="sr">Serbian</option>
                            <option value="st">Sesotho</option>
                            <option value="sn">Shona</option>
                            <option value="sd">Sindhi</option>
                            <option value="si">Sinhala</option>
                            <option value="sk">Slovak</option>
                            <option value="sl">Slovenian</option>
                            <option value="so">Somali</option>
                            <option value="es">Spanish</option>
                            <option value="su">Sundanese</option>
                            <option value="sw">Swahili</option>
                            <option value="sv">Swedish</option>
                            <option value="tg">Tajik</option>
                            <option value="ta">Tamil</option>
                            <option value="tt">Tatar</option>
                            <option value="te">Telugu</option>
                            <option value="th">Thai</option>
                            <option value="ti">Tigrinya</option>
                            <option value="ts">Tsonga</option>
                            <option value="tr">Turkish</option>
                            <option value="tk">Turkmen</option>
                            <option value="ak">Twi</option>
                            <option value="uk">Ukrainian</option>
                            <option value="ur">Urdu</option>
                            <option value="ug">Uyghur</option>
                            <option value="uz">Uzbek</option>
                            <option value="vi">Vietnamese</option>
                            <option value="cy">Welsh</option>
                            <option value="xh">Xhosa</option>
                            <option value="yi">Yiddish</option>
                            <option value="yo">Yoruba</option>
                            <option value="zu">Zulu</option>
                        </select>
                        <textarea id="tratext-popup-1" rows="4" cols="30"></textarea><br>
                    </td>
                </tr>
            </table>

            <button id="translateButton">Translate</button>
            <button id="applyButton">Apply</button>
            <button id="canceltransButton">Cancel</button>
            <button id="addColumnButton" onclick="addTransColumn()">Add Col</button>
            <button id="downloadTranslatedCsvButton">Download CSV</button>
        </div>
    </div>
    <script src="numtotext.js"></script>
    <script src="speakscript.js"></script>
    <script src="script.js"></script>
    <script src="app2.js"></script>

</body>

</html>